# Проект: Программа учета выдачи оборудования

## Статус
На данный момент программа не работает, так как было отключено api к базе данных.

## Описание
Этот проект представляет собой приложение для управления оборудованием, пользователями и запросами на использование оборудования. Приложение разработано с использованием Python и библиотеки PyQt5 для создания графического интерфейса. Оно позволяет:
- Управлять пользователями (добавление, редактирование, удаление).
- Управлять оборудованием (добавление, редактирование, удаление).
- Создавать и управлять запросами на использование оборудования.
- Проверять наличие оборудования и предлагать альтернативы, если оборудование отсутствует.
- Экспортировать данные в форматы Excel и Word.

## Технологии
- **Python** - основной язык программирования.
- **PyQt5** - библиотека для создания графического интерфейса.
- **Requests** - для выполнения HTTP-запросов к API.
- **dotenv** - для управления переменными окружения.
- **xlwt** - для создания Excel-файлов.
- **python-docx** - для создания Word-документов.
- **qdarkstyle** - для поддержки темного режима интерфейса.
- **Jinja2** - для генерации HTML-шаблонов писем.
- **BeautifulSoup** - для парсинга HTML-кода писем.
- **smtplib** - для отправки писем через SMTP.
- **imaplib** - для получения писем из почтового ящика через IMAP.
- **email** - для работы с MIME-сообщениями (создание и декодирование писем).

## Установка
1. Убедитесь, что у вас установлен Python 3.9 или выше.
2. Установите необходимые зависимости:
   ```bash
   pip install -r requirements.txt
   ```
3. Запустите приложение:
   ```bash
   python main_app.py
   ```

## Использование
### Вход в систему
При запуске приложения откроется окно входа, где необходимо ввести email и пароль. Если данные верны, откроется главное окно приложения.

### Управление пользователями
- **Добавление пользователя**: Нажмите кнопку "Добавить пользователя" и заполните форму.
- **Редактирование пользователя**: Выберите пользователя в таблице и измените необходимые данные.
- **Удаление пользователя**: Выберите пользователя и нажмите кнопку "Удалить".

### Управление оборудованием
- **Добавление оборудования**: Нажмите кнопку "Добавить оборудование" и заполните форму.
- **Редактирование оборудования**: Выберите оборудование в таблице и измените необходимые данные.
- **Удаление оборудования**: Выберите оборудование и нажмите кнопку "Удалить".

### Управление запросами
- **Создание запроса**: Нажмите кнопку "Добавить запрос" и заполните форму.
- **Изменение статуса запроса**: Выберите запрос и измените его статус с помощью выпадающего списка.

### Экспорт данных
- **Экспорт в Excel**: Выберите "Файл -> Экспорт в Excel" и укажите путь для сохранения файла.
- **Экспорт в Word**: Выберите "Файл -> Экспорт в Word" и укажите путь для сохранения файла.

## Авторы
- Болезнов Степан - разработка десктопного приложения и api для базы данных
- Ряднов Иван - разработка функционала работы с почтой и поиска альтернатив для оборудования

## Дополнительно

### Настройка почты
Для работы с почтой необходимо настроить SMTP-сервер. Для этого:
1. Переименуйте файл `.env.example` в `.env`.
2. Заполните переменные окружения в файле `.env` в соответствии с требованиями вашего почтового сервера:
   - `EMAIL_SENDER` — имя отправителя (например, MIEM).
   - `EMAIL_USERNAME` — ваш email для входа в почтовый аккаунт.
   - `EMAIL_PASSWORD` — пароль от почтового аккаунта.

### Как это работает
Программа проверяет почтовый ящик на наличие новых запросов от пользователей. Если запросы найдены, программа:
1. Конвертирует запросы в словарь и проверяет информацию пользователя.
2. Если данные корректны, программа сохраняет информацию о новом пользователе в базу данных и одобряет запрос.
3. Все запросы экспортируются в файлы Excel и Word.
4. Если во время проверки возникают ошибки или запрос не соответствует требованиям (например, указано некорректное оборудование), программа отправляет пользователю письмо с отказом и указанием причины.
